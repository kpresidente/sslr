const updatePriorInvoice=async(e,i)=>{const t=`${FLD.Invoices.TotalPercent}_raw`,n=(await db(TBL.Invoices).filter(FLD.Invoices.Contract,"is",sub(i,FLD.Invoices.Contract,"id")).filter(FLD.Invoices.Exists,"is",1).get()).data.filter((e=>e[t]<i[t]));if(0==n.length)var s="";else if(0==n.length)s=n[0].id;else{s=n.reduce(((e,i)=>e[t]>i[t]?e:i)).id}return await db(TBL.Invoices).key(i.id).update({[FLD.Invoices.PriorInvoice]:s})};