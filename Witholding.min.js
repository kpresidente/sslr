function setWitholding(t){db(TBL.PayrollWeeks).key(sub(t,FLD.PayrollInstallers.PayrollWeek,"id")).get().then((e=>(payWeek=e.data[0],new Promise(((a,l)=>{var s=new XMLHttpRequest;s.open("post","https://taxee.io/api/v2/calculate/"+payWeek[FLD.PayrollWeeks.EndedYear],!0),s.setRequestHeader("Authorization","Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJBUElfS0VZX01BTkFHRVIiLCJodHRwOi8vdGF4ZWUuaW8vdXNlcl9pZCI6IjVhMjU5ZjhmOWZhMTBmMjM3OWEwOTdkNyIsImh0dHA6Ly90YXhlZS5pby9zY29wZXMiOlsiYXBpIl0sImlhdCI6MTUxMjQxNTExOX0.CqAgMo5kqTRjxN_SjB3K5iKFZ-9G8dJrsAAPuiUY3h0"),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onload=function(){var t={status:this.status,statusText:s.statusText};this.status>=200&&this.status<300?(t.data=JSON.parse(this.response),a(t)):l(t)},s.onerror=function(){l(e)},s.send(`state=${t[FLD.PayrollInstallers.State]||"TN"}&filing_status=${t[FLD.PayrollInstallers.FilingStatus].toLowerCase().replace(" ","_")}&pay_periods=52&pay_rate=${t[FLD.PayrollInstallers.TotalWages+"_raw"]}&exemptions=${t[FLD.PayrollInstallers.Exemptions]}`)}))))).then((e=>{var a=e.data.per_pay_period,l={[FLD.PayrollInstallers.FICAWitheld]:Math.round(100*a.fica.amount)/100,[FLD.PayrollInstallers.FederalWitheld]:Math.round(100*a.federal.amount)/100,[FLD.PayrollInstallers.StateWitheld]:Math.round(100*a.state.amount)/100};return db(TBL.PayrollInstallers).key(t.id).update(l)})).catch((t=>{MsgBox("Error calculating witholdings!  You will have to set them manually.",`${t.statusText}, ${t.status}`)})).then((t=>(Knack.hideSpinner(),t)))}