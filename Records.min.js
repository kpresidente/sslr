var KNACK_APPLICATION_ID=Knack.application_id,KNACK_API_KEY="e9299eb0-9304-11e6-805f-fdc50f60d512",KNACK_URL=Knack.api_dev+"/",KNACK_HEADER={"X-Knack-Application-Id":KNACK_APPLICATION_ID,"X-Knack-REST-API-Key":KNACK_API_KEY},dbLock={releaseTime:Date.now(),sentCount:0};function sub(t,e,a,s=0){try{return e=e.replace("_raw","")+"_raw",(e=[].concat(t[e]))[s][a]}catch(t){return}}var dbWait=0,db=function(t){var e=KNACK_URL,a={},s={filter:function(t,e,a=""){var s={},r=["field","operator","value"];return Object.entries(arguments).forEach((([t,e])=>s[r[t]]=e)),n([s])},filters:n,format:i,match:function(t){return a.filter.match=t,Object.assign({},{get:c},s)},page:function(t){return a.page=t,Object.assign({},{get:c},s)},rows:function(t){return a.rows_per_page=t,Object.assign({},{get:c},s)},sort:function(t,e){return a.sort_field=t,a.sort_order=e,Object.assign({},{get:c},s)}},r={create:async function(t){return o("POST",t)},delete:async function(){return o("DELETE")},get:c,update:async function(t){return o("PUT",t)}};return t.startsWith("object_")?e+=`objects/${t}/records`:t.startsWith("view_")&&(r.displayed=displayed,e+=`pages/${VW[t].attributes.scene.key}/views/${t}/records`),{key:function(t){return e+=`/${t}`,Object.assign({},{format:i},r)},...r,...s};function n(t){return a.filters=a.filters?JSON.parse(a.filters):{},a.filters.rules=a.filters.rules||[],a.filters.match=a.filters.match||"and",a.filters.rules.push(...t),a.filters=JSON.stringify(a.filters),Object.assign({},{get:c},s)}function i(t){return a.format=t,Object.assign({},{get:c},s)}async function c(){if("rows_per_page"in a||(a.rows_per_page=1e3),"page"in a)return o("GET");{let t=await o("GET");"pages"in t||(t.pages=1);let e=[t];for(a.page=2;a.page<=t.pages;a.page++)e.push(o("GET"));let s=(await Promise.all(e)).sort(((t,e)=>t.page<e.page?-1:1)).flatMap((t=>t.data));return{status:200,statusText:"OK",data:s}}}async function o(t,s){const r=new URLSearchParams;Object.entries(a).forEach((([t,e])=>{r.append(t,e)}));const n="?"+r.toString();return new Promise(((a,r)=>{var i=new XMLHttpRequest;i.open(t,e+n),i.setRequestHeader("X-Knack-Application-Id",KNACK_APPLICATION_ID),i.setRequestHeader("X-Knack-REST-API-Key",KNACK_API_KEY),i.setRequestHeader("Content-Type","application/json"),i.onload=function(t){200==this.status?a(this):r(this)},i.onerror=function(t){r(this)},i.send(JSON.stringify(s))})).then((t=>("total_pages"in(t={status:t.status,statusText:t.statusText,data:JSON.parse(t.response)}).data?(t.pages=t.data.total_pages,t.page=t.data.current_page,t.data=[].concat(t.data.records)):t.data=[].concat(t.data),t))).catch((async e=>429==e.status?(dbWait=1e3,o(t,s)):{status:e.status,statusText:e.statusText,data:e}))}};async function updateKey(t,e,a=0){try{const a=t.source.object;await db(a).key(e.id).update({[FLD[a].Key]:e.id})}catch(s){if(a<5)return updateKey(t,e,a++)}}